# 意愿值系统

意愿值系统是 YesImBot 最独特的功能之一，它使机器人能够模拟真实人类的交流模式，在群聊中自然地参与讨论，而不是被动等待指令或过度活跃。

## 什么是意愿值系统？

意愿值系统是一种控制机器人主动发言频率的机制。它通过动态计算和调整"意愿值"（Willingness Value），来决定机器人是否应该对群聊中的消息做出回应。这种机制使机器人的行为更加自然，避免了传统聊天机器人要么过于沉默、要么过度活跃的问题。

## 工作原理

意愿值系统的工作原理如下：

1. **基础意愿值**：每个消息都有一个基础意愿值，表示机器人对该消息的初始兴趣程度
2. **动态调整**：系统会根据多种因素动态调整意愿值，包括：
   - 消息内容的相关性
   - 消息是否包含机器人的名字或关键词
   - 消息是否是对机器人之前回复的回应
   - 群聊的活跃度
   - 机器人最近的发言频率
3. **阈值判断**：当调整后的意愿值超过预设阈值时，机器人会做出回应
4. **冷却期**：回应后，系统会进入短暂的冷却期，降低机器人连续发言的概率

这种机制使机器人能够在适当的时机加入对话，既不会打断正常的群聊流程，也不会因为过度沉默而被忽视。

## 配置参数

意愿值系统可以通过以下参数进行配置：

| 参数名 | 描述 | 默认值 | 推荐范围 |
|-------|------|-------|---------|
| `BaseWillingness` | 基础意愿值，表示机器人对一般消息的兴趣程度 | 0.2 | 0.1-0.3 |
| `WillingnessThreshold` | 意愿值阈值，超过此值时机器人会回应 | 0.7 | 0.6-0.8 |
| `NameMentionBoost` | 当消息中提到机器人名字时的意愿值提升 | 0.5 | 0.4-0.6 |
| `KeywordBoost` | 当消息中包含关键词时的意愿值提升 | 0.3 | 0.2-0.4 |
| `ReplyToMeBoost` | 当消息是对机器人回复的回应时的意愿值提升 | 0.6 | 0.5-0.7 |
| `CooldownPeriod` | 回应后的冷却期（秒） | 60 | 30-120 |
| `ActivityFactor` | 群聊活跃度对意愿值的影响因子 | 0.1 | 0.05-0.2 |

## 配置示例

以下是一个意愿值系统的配置示例：

```yaml
WillingnessSystem:
  BaseWillingness: 0.2
  WillingnessThreshold: 0.7
  NameMentionBoost: 0.5
  KeywordBoost: 0.3
  ReplyToMeBoost: 0.6
  CooldownPeriod: 60
  ActivityFactor: 0.1
  Keywords:
    - "AI"
    - "人工智能"
    - "聊天机器人"
    - "问题"
    - "帮忙"
```

## 最佳实践

为了获得最佳的意愿值系统效果，建议遵循以下最佳实践：

1. **适度调整基础意愿值**：基础意愿值过高会导致机器人过于活跃，过低则会使机器人过于沉默
2. **设置合理的阈值**：阈值应该足够高，确保机器人只在适当的时机发言
3. **配置相关关键词**：根据群聊的主题和目的，配置相关的关键词，使机器人能够对相关话题做出回应
4. **定期调整参数**：根据实际使用情况，定期调整参数，以获得最佳效果
5. **结合记忆系统**：意愿值系统与记忆系统结合使用，可以使机器人的回应更加连贯和上下文相关

## 常见问题

### 机器人回应过于频繁

如果机器人回应过于频繁，可以尝试以下调整：

- 降低基础意愿值（`BaseWillingness`）
- 提高意愿值阈值（`WillingnessThreshold`）
- 延长冷却期（`CooldownPeriod`）

### 机器人几乎不回应

如果机器人几乎不回应，可以尝试以下调整：

- 提高基础意愿值（`BaseWillingness`）
- 降低意愿值阈值（`WillingnessThreshold`）
- 增加名字提及和关键词的提升值（`NameMentionBoost`和`KeywordBoost`）
- 添加更多相关关键词

### 机器人回应不相关的消息

如果机器人回应不相关的消息，可以尝试以下调整：

- 调整关键词列表，移除可能导致误触发的关键词
- 提高意愿值阈值（`WillingnessThreshold`）
- 结合记忆系统，提高上下文理解能力
