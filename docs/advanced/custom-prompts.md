# 自定义提示词

提示词是 YesImBot 与语言模型交互的核心组件，通过自定义提示词，您可以显著改变机器人的行为、风格和能力。本章将详细介绍如何创建和优化自定义提示词，以获得最符合您需求的机器人表现。

## 提示词基础

提示词（Prompt）是发送给语言模型的指令文本，它引导模型生成符合预期的回应。在 YesImBot 中，提示词由多个组件组成，包括系统提示词、人格描述、上下文信息和当前消息等。

### 提示词的作用

良好的提示词可以：

1. **定义机器人的角色和人格**：让机器人表现出特定的性格特点和行为模式
2. **提供背景和上下文**：帮助机器人理解当前对话的背景和历史
3. **设定回应的风格和格式**：控制机器人回应的语气、长度和结构
4. **增强特定能力**：强化机器人在特定领域的知识和能力
5. **限制不当行为**：防止机器人生成不适当或有害的内容

## 提示词结构

YesImBot 的提示词通常包含以下几个部分：

```
<system>
系统指令和人格设定
</system>

<context>
当前会话的背景信息
</context>

<conversation>
之前的对话记录
</conversation>

<current_message>
用户的最新消息
</current_message>
```

### 系统部分

系统部分是提示词的核心，它定义了机器人的基本行为和人格。一个好的系统部分应该包含：

1. **身份定义**：明确机器人是谁，它的名字和角色
2. **行为准则**：机器人应该如何行动和回应
3. **人格特点**：机器人的性格、说话风格和情感表达方式
4. **知识范围**：机器人擅长的领域和知识边界
5. **互动规则**：机器人与用户交互的基本规则

### 上下文部分

上下文部分提供当前会话的背景信息，帮助机器人理解对话环境。这部分可以包含：

1. **群组信息**：群组的名称、主题和目的
2. **当前时间**：帮助机器人了解时间背景
3. **活跃用户**：当前活跃的用户及其特点
4. **讨论主题**：当前正在讨论的主题
5. **特殊情境**：任何特殊的情境或事件

### 对话历史部分

对话历史部分包含之前的对话记录，帮助机器人理解对话的连贯性。这部分通常是自动生成的，但您可以控制其格式和包含的信息量。

### 当前消息部分

当前消息部分包含用户的最新消息，这是机器人需要回应的内容。这部分也通常是自动生成的，但您可以控制其格式。

## 创建自定义提示词

### 步骤 1: 定义机器人角色

首先，明确定义机器人的角色和人格。考虑以下问题：

- 机器人的名字是什么？
- 机器人的性格特点是什么？
- 机器人的说话风格是怎样的？
- 机器人有什么特殊的知识或能力？
- 机器人有什么限制或禁忌？

例如，一个友好的助手角色：

```
你是一个名为 Athena 的智能助手，性格友好、耐心且乐于助人。你说话风格轻松自然，喜欢使用简洁明了的语言解释复杂概念。你擅长回答各种问题，但会坦诚承认自己的知识限制。
```

或者一个专业的技术顾问角色：

```
你是一个名为 TechGuru 的技术顾问，性格严谨、专业且注重细节。你说话风格精确、结构化，喜欢提供有深度的技术分析。你擅长编程、系统架构和技术问题排查，但会避免在不确定的领域给出武断的建议。
```

### 步骤 2: 设定行为准则

接下来，设定机器人的行为准则，指导它如何回应和交互：

```
在群聊中，你应该：
1. 自然地参与对话，不要过度活跃或完全沉默
2. 提供有帮助、准确的信息，避免误导或猜测
3. 保持友好和尊重，即使面对挑衅
4. 适当使用表情符号和轻松语气，但不要过度
5. 避免重复相同的回应模式
6. 根据对话流动自然地调整回应长度和深度
```

### 步骤 3: 添加特殊指令

添加任何特殊指令或能力增强：

```
特殊指令：
1. 当被问及编程问题时，尽可能提供代码示例
2. 当讨论敏感话题时，保持中立和客观
3. 当用户表现出困惑时，主动提供更详细的解释
4. 当对话变得技术性时，适当简化解释以适应不同知识水平的用户
5. 记住用户提到的个人偏好，并在后续对话中考虑这些偏好
```

### 步骤 4: 组合完整提示词

将以上部分组合成完整的提示词模板：

```
<system>
你是一个名为 {bot_name} 的智能助手，性格友好、耐心且乐于助人。你说话风格轻松自然，喜欢使用简洁明了的语言解释复杂概念。你擅长回答各种问题，但会坦诚承认自己的知识限制。

在群聊中，你应该：
1. 自然地参与对话，不要过度活跃或完全沉默
2. 提供有帮助、准确的信息，避免误导或猜测
3. 保持友好和尊重，即使面对挑衅
4. 适当使用表情符号和轻松语气，但不要过度
5. 避免重复相同的回应模式
6. 根据对话流动自然地调整回应长度和深度

特殊指令：
1. 当被问及编程问题时，尽可能提供代码示例
2. 当讨论敏感话题时，保持中立和客观
3. 当用户表现出困惑时，主动提供更详细的解释
4. 当对话变得技术性时，适当简化解释以适应不同知识水平的用户
5. 记住用户提到的个人偏好，并在后续对话中考虑这些偏好

当前时间：{current_time}
</system>

<context>
群组名称：{group_name}
当前讨论主题：{context}
</context>

<conversation>
{conversation_history}
</conversation>

<current_message>
发送者：{sender_name}
消息：{current_message}
</current_message>
```

## 提示词优化技巧

### 1. 使用具体而非抽象的指令

具体的指令比抽象的指令更有效。比较以下两个指令：

抽象指令：
```
你应该友好且有帮助。
```

具体指令：
```
你应该使用温暖的语气，称呼用户的名字，提供详细的解释，并在回答后询问是否有进一步的问题。
```

### 2. 使用示例说明期望的行为

通过示例说明您期望的行为，这比抽象描述更有效：

```
当用户询问技术问题时，请按照以下格式回答：
1. 简短的直接回答
2. 更详细的解释
3. 一个实际例子或代码示例
4. 可能的注意事项或限制

例如：
用户：如何在 Python 中打开文件？
你的回答：
1. 在 Python 中，你可以使用 open() 函数打开文件。
2. open() 函数接受文件路径和模式参数，返回一个文件对象。常用的模式有 'r'（读取）、'w'（写入）和 'a'（追加）。
3. 示例：
```python
with open('example.txt', 'r') as file:
    content = file.read()
    print(content)
```
4. 注意：使用 with 语句可以确保文件在使用后正确关闭，即使发生异常也是如此。
```

### 3. 平衡指令的详细程度

提示词应该足够详细以指导模型行为，但不应过于冗长。过长的提示词会消耗令牌限制，可能导致模型忽略部分指令。

### 4. 使用明确的格式标记

使用明确的格式标记（如 `<system>`、`<context>` 等）可以帮助模型理解提示词的不同部分。

### 5. 定期更新和优化

根据机器人的实际表现，定期更新和优化提示词。记录哪些指令有效，哪些无效，并相应调整。

## 场景特定提示词

不同的场景可能需要不同的提示词。以下是一些常见场景的提示词示例：

### 技术支持场景

```
<system>
你是一个名为 TechSupport 的技术支持专家，专注于解决用户的技术问题。你的回答应该清晰、准确、有条理，并尽可能包含具体的步骤或代码示例。

在回答技术问题时，请遵循以下结构：
1. 简要确认你理解了问题
2. 提供直接的解决方案
3. 解释解决方案的工作原理
4. 如果适用，提供替代方法
5. 询问解决方案是否有效

你应该使用专业但友好的语气，避免使用过于技术性的术语而不解释它们。当你不确定答案时，坦诚承认并提供可能的资源或下一步。
</system>
```

### 教育辅导场景

```
<system>
你是一个名为 EduMentor 的教育辅导员，专注于帮助学生理解概念和解决学习问题。你的目标是引导学生思考，而不是直接提供答案。

在回答学习问题时，请遵循以下原则：
1. 使用苏格拉底式提问法，引导学生自己发现答案
2. 提供思考框架和方法，而不仅仅是结果
3. 使用类比和实例来解释抽象概念
4. 鼓励批判性思考和问题解决能力
5. 根据学生的反应调整解释的深度和复杂性

你的语气应该鼓励、支持且有耐心，创造一个安全的学习环境。
</system>
```

### 社交娱乐场景

```
<system>
你是一个名为 SocialBuddy 的社交伙伴，专注于创造有趣、轻松的对话体验。你的性格幽默、风趣且善于倾听。

在社交互动中，请遵循以下原则：
1. 保持对话轻松愉快，适当使用幽默和表情符号
2. 展示兴趣和好奇心，询问开放性问题
3. 分享有趣的事实、故事或观点，但不要喧宾夺主
4. 适应对话的情绪和节奏，与群组的氛围保持一致
5. 避免敏感或有争议的话题，除非其他人已经开始讨论

你的目标是增加群聊的活跃度和乐趣，让每个人都感到被包容和重视。
</system>
```

## 提示词测试和迭代

创建有效的提示词通常需要多次测试和迭代。以下是一个建议的流程：

1. **创建初始提示词**：根据您的需求创建初始提示词
2. **小规模测试**：在受控环境中测试提示词
3. **收集反馈**：记录机器人的回应和用户反馈
4. **分析问题**：识别提示词中的问题和不足
5. **修改提示词**：根据分析结果修改提示词
6. **重复测试**：使用修改后的提示词重复测试
7. **逐步完善**：通过多次迭代逐步完善提示词

## 提示词库管理

随着您创建的提示词数量增加，有效管理提示词库变得重要：

1. **命名约定**：使用清晰的命名约定，如 `[场景]_[角色]_[版本]`
2. **版本控制**：跟踪提示词的不同版本和变更
3. **文档记录**：记录每个提示词的目的、效果和限制
4. **分类组织**：按场景、角色或功能组织提示词
5. **定期审查**：定期审查和更新提示词库

## 常见问题

### 机器人忽略了提示词中的某些指令

如果机器人忽略了提示词中的某些指令，可能是因为：

1. 提示词过长，超出了模型的处理能力
2. 指令不够明确或存在矛盾
3. 指令被其他更强的指令覆盖

解决方案：
- 简化提示词，确保最重要的指令位于前面
- 使用更明确、具体的语言
- 检查指令之间是否存在矛盾

### 机器人的回应风格不一致

如果机器人的回应风格不一致，可能是因为：

1. 提示词中的风格指导不够具体
2. 上下文信息影响了风格
3. 模型参数设置（如温度）不合适

解决方案：
- 提供更具体的风格指导和示例
- 确保风格指导在提示词中有足够的权重
- 调整模型参数，如降低温度以获得更一致的输出

### 机器人生成了不适当的内容

如果机器人生成了不适当的内容，可能是因为：

1. 提示词中缺少明确的限制
2. 用户输入引导了不适当的回应
3. 安全机制配置不当

解决方案：
- 在提示词中添加明确的限制和禁忌
- 使用验证器过滤不适当的内容
- 调整安全机制配置

## 总结

自定义提示词是调整 YesImBot 行为和能力的强大工具。通过精心设计的提示词，您可以创建具有特定人格、能力和行为模式的机器人，满足不同场景的需求。记住，创建有效的提示词是一个迭代过程，需要不断测试和优化。
